
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tqcalc.f &#8212; Mark Drela Tools</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cdfun.f" href="cdfun_f.html" />
    <link rel="prev" title="qprop.f" href="qprop_f.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/lpp.gif" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mark Drela Tools</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Refactoring Mark Drela’s Tools
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xfoil/xfoil.html">
   XFoil - Airfoil Analysis Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qprop.html">
   QPROP: Propeller Analysis Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qprop-algorithms.html">
   QProp Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qprop_f.html">
   qprop.f
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   tqcalc.f
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cdfun_f.html">
   cdfun.f
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gvcalc_f.html">
   gvcalc.f
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spline_f.html">
   spline.f
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/qprop/tqcalc_f.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/rblack42/math-magik-drela"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/rblack42/math-magik-drela/issues/new?title=Issue%20on%20page%20%2Fqprop/tqcalc_f.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>tqcalc.f</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="tqcalc-f">
<h1>tqcalc.f<a class="headerlink" href="#tqcalc-f" title="Permalink to this headline">¶</a></h1>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span>C***********************************************************************
C    Module:  tqcalc.f
C 
C    Copyright (C) 2003 Mark Drela 
C 
C    This program is free software; you can redistribute it and/or modify
C    it under the terms of the GNU General Public License as published by
C    the Free Software Foundation; either version 2 of the License, or
C    (at your option) any later version.
C
C    This program is distributed in the hope that it will be useful,
C    but WITHOUT ANY WARRANTY; without even the implied warranty of
C    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
C    GNU General Public License for more details.
C
C    You should have received a copy of the GNU General Public License
C    along with this program; if not, write to the Free Software
C    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
C***********************************************************************

      SUBROUTINE TQCALC(N,C,B,R,DR,
     &amp;              VA,VT,CL,CD,STALL,
     &amp;              BLDS,RAD,VEL,OMG,DBE,
     &amp;              RHO,RMU,VSO,
     &amp;              CL0,DCLDA,CLMIN,CLMAX,MCRIT,
     &amp;              CD0,CD2U,CD2L,CLCD0,REREF,REEXP,
     &amp;              TP, TP_VEL, TP_OMG, TP_DBE, TP_C, TP_B,
     &amp;              QP, QP_VEL, QP_OMG, QP_DBE, QP_C, QP_B )
      IMPLICIT REAL(A-H,M,O-Z)
      REAL C(N), B(N), R(N), DR(N)
      REAL CL0(N), DCLDA(N), CLMIN(N), CLMAX(N), MCRIT(N)
      REAL CD0(N), CD2U(N), CD2L(N)
      REAL CLCD0(N)
      REAL REREF(N), REEXP(N)
C
      REAL VA(N), VT(N), CL(N), CD(N)
      REAL TP_C(N), TP_B(N),
     &amp;     QP_C(N), QP_B(N)
      LOGICAL STALL(N)
C
C-----------------------------------------------------
C     Computes propeller thrust and torque
C     by integrating forces along radius.
C
C
C  Input   N      number of radial stations  i = 1..N
C          C(i)   chords
C          B(i)   angles (radians)
C          R(i)   radii
C          DR(i)  radius interval for i station
C
C          BLDS    number of blades
C          RAD     tip radius  (for Prandtl&#39;s factor)
C          VEL     forward flight speed
C          OMG     rotational speed  (radians/time)
C          DBE     delta(B) to be added to all B(i) angles
C
C          RHO     fluid density
C          RMU     fluid viscosity
C
C          CL0(i)     constants for CL(alpha,M) function
C          DCLDA(i)
C          CLMIN(i)
C          CLMAX(i)
C          MCRIT(i)
C
C          CD0(i)     constant  coefficient for CD(CL) function
C          CD2(i)     quadratic coefficient for CD(CL) function
C          CLCD0(i)   CL at minimum drag point (where CD=CD0)
C          REREF(i)   reference Reynolds number where CD(CL) applies
C          REEXP(i)   Re-scaling exponent:   CD ~ (Re/REREF)^REEXP
C
C
C  Output  VA(i)    axial induced velocity
C          VT(i)    tangential induced velocity
C          CL(i)    section lift coefficient
C          CD(i)    section drag coefficient
C          STALL(i) T if alpha is outside stall limits
C
C          TP       prop thrust
C          QP       prop torque
C          ()_VEL   derivatives  d()/dVEL
C          ()_OMG   derivatives  d()/dOMG
C          ()_DBE   derivatives  d()/dDBE
C          ()_C(i)  derivatives  d()/dC(i)
C          ()_B(i)  derivatives  d()/dB(i)
C
C-----------------------------------------------------
      LOGICAL LCONV
C
      DATA MSQMAX    / 0.9    /
C
C---- clear for accumulation
      TP     = 0.
      TP_VEL = 0.
      TP_OMG = 0.
      TP_DBE = 0.
C
      QP     = 0.
      QP_VEL = 0.
      QP_OMG = 0.
      QP_DBE = 0.
C
C---- go over radial stations
      DO I = 1, N
        BTOT = B(I) + DBE
        CALL GVCALC(C(I),BTOT,R(I),
     &amp;              BLDS,RAD,VEL,OMG,VSO,
     &amp;              CL0(I),DCLDA(I),CLMIN(I),CLMAX(I),MCRIT(I),
     &amp;        GAM  ,GAM_VEL,GAM_OMG,GAM_C,GAM_B, 
     &amp;        VA(I), VA_VEL, VA_OMG, VA_C, VA_B,
     &amp;        VT(I), VT_VEL, VT_OMG, VT_C, VT_B,
     &amp;        CL(I), CL_VEL, CL_OMG, CL_C, CL_B, STALL(I), LCONV)
C
C------ perturbation imposed axial and tangential velocities
        U0A = 0.
        U0T = 0.
        GAM_U0A = 0.
        GAM_U0T = 0.
        VA_U0A = 0.
        VA_U0T = 0.
        VT_U0A = 0.
        VT_U0T = 0.
        CL_U0A = 0.
        CL_U0T = 0.
C
C------ total imposed axial and tangential velocities
        UA     = VEL   + U0A
        UA_VEL = 1.0
        UA_U0A =         1.0
C
        UT     = OMG*R(I) - U0T
        UT_OMG =     R(I)
        UT_U0T =          - 1.0
C
C------ geometric velocity
        WZ = SQRT(UA**2 + UT**2)
        WZ_VEL = (UA/WZ)*UA_VEL
        WZ_OMG = (UT/WZ)*UT_OMG
C
C------ total axial and tangential velocities
        WA     = UA     + VA(I)
        WA_VEL = UA_VEL + VA_VEL
        WA_OMG =          VA_OMG
        WA_B   =          VA_B  
        WA_C   =          VA_C
        WA_U0A = UA_U0A + VA_U0A
        WA_U0T =          VA_U0T
C
        WT     = UT     - VT(I)
        WT_VEL =        - VT_VEL
        WT_OMG = UT_OMG - VT_OMG
        WT_B   =        - VT_B  
        WT_C   =        - VT_C 
        WT_U0A =        - VT_U0A
        WT_U0T = UT_U0T - VT_U0T
C
C------ total velocity^2
        WSQ = WA**2 + WT**2
        WSQ_VEL = 2.0*WA*WA_VEL + 2.0*WT*WT_VEL
        WSQ_OMG = 2.0*WA*WA_OMG + 2.0*WT*WT_OMG
        WSQ_B   = 2.0*WA*WA_B   + 2.0*WT*WT_B  
        WSQ_C   = 2.0*WA*WA_C   + 2.0*WT*WT_C  
        WSQ_U0A = 2.0*WA*WA_U0A + 2.0*WT*WT_U0A
        WSQ_U0T = 2.0*WA*WA_U0T + 2.0*WT*WT_U0T
C
C------ total velocity
        W = SQRT(WSQ)
        W_VEL = 0.5*WSQ_VEL/W
        W_OMG = 0.5*WSQ_OMG/W
        W_B   = 0.5*WSQ_B  /W
        W_C   = 0.5*WSQ_C  /W
        W_U0A = 0.5*WSQ_U0A/W
        W_U0T = 0.5*WSQ_U0T/W
C
C------ chord Reynolds number
        RE     = RHO*C(I)*W    /RMU
        RE_VEL = RHO*C(I)*W_VEL/RMU
        RE_OMG = RHO*C(I)*W_OMG/RMU
        RE_B   = RHO*C(I)*W_B  /RMU
        RE_C   = RHO*C(I)*W_C  /RMU
     &amp;         + RHO     *W    /RMU
        RE_U0A = RHO*C(I)*W_U0A/RMU
        RE_U0T = RHO*C(I)*W_U0T/RMU
C
C------ local Mach and PG factor
        MSQ     = WSQ     / VSO**2
        MSQ_VEL = WSQ_VEL / VSO**2
        MSQ_OMG = WSQ_OMG / VSO**2
        MSQ_B   = WSQ_B   / VSO**2
        MSQ_C   = WSQ_C   / VSO**2
        MSQ_U0A = WSQ_U0A / VSO**2
        MSQ_U0T = WSQ_U0T / VSO**2
        IF(MSQ .GT. MSQMAX) THEN
         MSQ = MSQMAX
         MSQ_VEL = 0.
         MSQ_OMG = 0.
         MSQ_B   = 0.
         MSQ_C   = 0.
         MSQ_U0A = 0.
         MSQ_U0T = 0.
        ENDIF
C
        PG = 1.0 / SQRT(1.0 - MSQ)
        PG_MSQ = 0.5*PG / (1.0 - MSQ)
C
        PG_VEL = PG_MSQ*MSQ_VEL
        PG_OMG = PG_MSQ*MSQ_OMG
        PG_B   = PG_MSQ*MSQ_B
        PG_C   = PG_MSQ*MSQ_C
        PG_U0A = PG_MSQ*MSQ_U0A
        PG_U0T = PG_MSQ*MSQ_U0T
C
        MA = SQRT(MSQ)
        MA = MAX( MA , 1.0E-8 )
        MA_VEL = (0.5/MA)*MSQ_VEL
        MA_OMG = (0.5/MA)*MSQ_OMG
        MA_B   = (0.5/MA)*MSQ_B  
        MA_C   = (0.5/MA)*MSQ_C  
        MA_U0A = (0.5/MA)*MSQ_U0A
        MA_U0T = (0.5/MA)*MSQ_U0T
C
C------ set unstalled CD
        IF(CL(I).GT.CLCD0(I)) THEN
         CALL CDFUN(CL(I),RE,MA, 
     &amp;              CLCD0(I),CD0(I),CD2U(I),REREF,REEXP(I),MCRIT,
     &amp;              CD(I),CD_CL,CD_RE,CD_MA)
        ELSE
         CALL CDFUN(CL(I),RE,MA,
     &amp;              CLCD0(I),CD0(I),CD2L(I),REREF,REEXP(I),MCRIT,
     &amp;              CD(I),CD_CL,CD_RE,CD_MA)
        ENDIF
        CD_VEL = CD_CL*CL_VEL + CD_RE*RE_VEL + CD_MA*MA_VEL
        CD_OMG = CD_CL*CL_OMG + CD_RE*RE_OMG + CD_MA*MA_OMG
        CD_B   = CD_CL*CL_B   + CD_RE*RE_B   + CD_MA*MA_B   
        CD_C   = CD_CL*CL_C   + CD_RE*RE_C   + CD_MA*MA_C   
        CD_U0A = CD_CL*CL_U0A + CD_RE*RE_U0A + CD_MA*MA_U0A
        CD_U0T = CD_CL*CL_U0T + CD_RE*RE_U0T + CD_MA*MA_U0T
C
        IF(STALL(I)) THEN
C------- additional CD with normal-force stall model
         CALL DCDFUN(BTOT,WA,WT, CLCD0(I),CL0(I),DCLDA(I),
     &amp;               DCD,DCD_B,DCD_WA,DCD_WT)
C
         CD(I)  = CD(I)  + DCD
         CD_VEL = CD_VEL + DCD_WA*WA_VEL + DCD_WT*WT_VEL
         CD_OMG = CD_OMG + DCD_WA*WA_OMG + DCD_WT*WT_OMG
         CD_B   = CD_B   + DCD_WA*WA_B   + DCD_WT*WT_B   + DCD_B
         CD_C   = CD_C   + DCD_WA*WA_C   + DCD_WT*WT_C  
         CD_U0A = CD_U0A + DCD_WA*WA_U0A + DCD_WT*WT_U0A
         CD_U0T = CD_U0T + DCD_WA*WA_U0T + DCD_WT*WT_U0T
C
        ENDIF
C
C------ axial and tangential load/span
        HRC = 0.5*RHO*C(I)
        FA     = HRC*W    *(  CL(I) *WT     - CD(I) *WA    )
        FA_VEL = HRC*W_VEL*(  CL(I) *WT     - CD(I) *WA    )
     &amp;         + HRC*W    *(  CL_VEL*WT     - CD_VEL*WA
     &amp;                      + CL(I) *WT_VEL - CD(I) *WA_VEL)
        FA_OMG = HRC*W_OMG*(  CL(I) *WT     - CD(I) *WA    )
     &amp;         + HRC*W    *(  CL_OMG*WT     - CD_OMG*WA
     &amp;                      + CL(I) *WT_OMG - CD(I) *WA_OMG)
        FA_B   = HRC*W_B  *(  CL(I) *WT     - CD(I) *WA    )
     &amp;         + HRC*W    *(  CL_B  *WT     - CD_B  *WA
     &amp;                      + CL(I) *WT_B   - CD(I) *WA_B  )
        FA_C   = HRC*W_C  *(  CL(I) *WT     - CD(I) *WA    )
     &amp;         + HRC*W    *(  CL_C  *WT     - CD_C  *WA
     &amp;                      + CL(I) *WT_C   - CD(I) *WA_C  )
     &amp;     + 0.5*RHO*W    *(  CL(I) *WT     - CD(I) *WA    )
C
        FT     = HRC*W    *(  CL(I) *WA     + CD(I) *WT    )
        FT_VEL = HRC*W_VEL*(  CL(I) *WA     + CD(I) *WT    )
     &amp;         + HRC*W    *(  CL_VEL*WA     + CD_VEL*WT
     &amp;                      + CL(I) *WA_VEL + CD(I) *WT_VEL)
        FT_OMG = HRC*W_OMG*(  CL(I) *WA     + CD(I) *WT    )
     &amp;         + HRC*W    *(  CL_OMG*WA     + CD_OMG*WT
     &amp;                      + CL(I) *WA_OMG + CD(I) *WT_OMG)
        FT_B   = HRC*W_B  *(  CL(I) *WA     + CD(I) *WT    )
     &amp;         + HRC*W    *(  CL_B  *WA     + CD_B  *WT
     &amp;                      + CL(I) *WA_B   + CD(I) *WT_B  )
        FT_C   = HRC*W_C  *(  CL(I) *WA     + CD(I) *WT    )
     &amp;         + HRC*W    *(  CL_C  *WA     + CD_C  *WT
     &amp;                      + CL(I) *WA_C   + CD(I) *WT_C  )
     &amp;     + 0.5*RHO*W    *(  CL(I) *WA     + CD(I) *WT    )
C
C------ sum thrust and torque
        TP     = TP     + BLDS*FA    *DR(I)
        TP_VEL = TP_VEL + BLDS*FA_VEL*DR(I)
        TP_OMG = TP_OMG + BLDS*FA_OMG*DR(I)
        TP_DBE = TP_DBE + BLDS*FA_B  *DR(I)
        TP_B(I) =         BLDS*FA_B  *DR(I)
        TP_C(I) =         BLDS*FA_C  *DR(I)
C
        QP     = QP     + BLDS*FT    *DR(I)*R(I)
        QP_VEL = QP_VEL + BLDS*FT_VEL*DR(I)*R(I)
        QP_OMG = QP_OMG + BLDS*FT_OMG*DR(I)*R(I)
        QP_DBE = QP_DBE + BLDS*FT_B  *DR(I)*R(I)
        QP_B(I) =         BLDS*FT_B  *DR(I)*R(I)
        QP_C(I) =         BLDS*FT_C  *DR(I)*R(I)

c       write(*,*) i
c       write(*,*) tp, qp
c       write(*,*) tp_vel, qp_vel
c       write(*,*) tp_omg, qp_omg
c       write(*,*) tp_b(i),qp_b(i)
c       write(*,*) tp_c(i),qp_c(i)
c       pause
c
C
      ENDDO
C
      RETURN
      END
</pre></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./qprop"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="qprop_f.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">qprop.f</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="cdfun_f.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">cdfun.f</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Roie R. Black<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>